üöÄ Deploying Meme Token Factory...
ADMIN_PRIVATE_KEY=0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
USER1_KEY=0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
USER2_KEY=0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a
USER3_KEY=0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a
üì¶ Deploying implementation and factory...
ERC20_IMPL_ADDRESS=0x78155E681c54Da4c25B6228753EcbfF5d8C2Def8
üì¶ Deploying factory...
FACTORY_ADDRESS=0x3c5eC7698538a74C15Ca01C6cbb5FD6cbbae43AC
üì¶ Deploying proxy using factory...

blockHash            0x8aa84d04ca4b52a08e4002594eb5fdbb84e82b97a474430852f3ca1261b19db7
blockNumber          23103021
contractAddress
cumulativeGasUsed    273382
effectiveGasPrice    638831976
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              273382
logs                 []
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
root
status               1 (success)
transactionHash      0xda2773d67c1ea01c05284b058593dd9bbb47c81f96d8940b45fca8aa7939140a
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x3c5eC7698538a74C15Ca01C6cbb5FD6cbbae43AC
üì¶ Getting deployed proxy address...
PROXY_ADDRESS=0x38Fcae0544337e84919FE58FEd9EF3965E86384F
üîê Authorizing Router to spend tokens for liquidity provision...
Token owner (USER1) authorizes Router to spend tokens...

blockHash            0x8ef259ed3c8ad740c8e167c744deebcb1c4ff3796c72a8d3d2020e3417eb75ae
blockNumber          23103022
contractAddress
cumulativeGasUsed    49641
effectiveGasPrice    561183043
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              49641
logs                 [{"address":"0x38fcae0544337e84919fe58fed9ef3965e86384f","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"],"data":"0x00000000000000000000000000000000000000000000d3c21bcecceda1000000","blockHash":"0x8ef259ed3c8ad740c8e167c744deebcb1c4ff3796c72a8d3d2020e3417eb75ae","blockNumber":"0x160862e","blockTimestamp":"0x6897284b","transactionHash":"0xed086fe45efb72f4ec7195bb69c8235ce8152dd5aa3b239b04d8761dfa014520","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000001000000000000010000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000020000010000000000000000000000000000001000000000000000000000002000000
root
status               1 (success)
transactionHash      0xed086fe45efb72f4ec7195bb69c8235ce8152dd5aa3b239b04d8761dfa014520
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x38Fcae0544337e84919FE58FEd9EF3965E86384F
Router authorization completed
üß™ Testing the deployed proxy...
Calling decimals() on proxy:
18
Calling name() on proxy:
"Meme1"
Calling symbol() on proxy:
"MEME1"
Calling perMint() on proxy:
10000000000000000000 [1e19]
Calling price() on proxy:
100000000000 [1e11]
Calling factory() on proxy:
0x3c5eC7698538a74C15Ca01C6cbb5FD6cbbae43AC
Calling owner() on proxy:
0x70997970C51812dc3A010C7d01b50e0d17dc79C8
Calling totalSupply() on proxy (should be 0 initially):
0
üí∞ Checking initial balances...
USER1 balance:
9999999797497149299605
USER2 balance:
10000000000000000000000
USER3 balance:
10000000000000000000000
ADMIN balance:
9999997182805637669221
ü™ô Testing minting with USER2...
USER2 mints tokens from the deployed meme token...
Token price: 100000000000 [1e11] wei
Token state before minting:
Total supply: 0
Per mint amount: 10000000000000000000 [1e19]
Factory address: 0x3c5eC7698538a74C15Ca01C6cbb5FD6cbbae43AC
Expected factory: 0x3c5eC7698538a74C15Ca01C6cbb5FD6cbbae43AC
üîê Token owner (USER1) authorizes Factory to spend tokens for liquidity provision...

blockHash            0xb57d7c4802fe5909baeb9b527420a52aa5d3bdc90e2d0f384e1ef8cde594a1bf
blockNumber          23103023
contractAddress
cumulativeGasUsed    49641
effectiveGasPrice    492437170
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              49641
logs                 [{"address":"0x38fcae0544337e84919fe58fed9ef3965e86384f","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x0000000000000000000000003c5ec7698538a74c15ca01c6cbb5fd6cbbae43ac"],"data":"0x00000000000000000000000000000000000000000000d3c21bcecceda1000000","blockHash":"0xb57d7c4802fe5909baeb9b527420a52aa5d3bdc90e2d0f384e1ef8cde594a1bf","blockNumber":"0x160862f","blockTimestamp":"0x6897284b","transactionHash":"0x73804fc2e9ce69689dbe0ebae59f6a5f6ab550113aa783c35ae84f9b2d87d219","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom            0x00000000000000000002000000000000000001000000000000000000000004000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000080000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000011000000000000000000000002000000
root
status               1 (success)
transactionHash      0x73804fc2e9ce69689dbe0ebae59f6a5f6ab550113aa783c35ae84f9b2d87d219
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x38Fcae0544337e84919FE58FEd9EF3965E86384F
Attempting to mint tokens...
‚úÖ USER2 successfully minted tokens!
üí∞ Checking balances after minting...
USER2 token balance:
9500000000000000000 [9.5e18]
Total supply after minting:
10000000000000000000 [1e19]
USER2 ETH balance after minting:
9999998772456836902824
ADMIN ETH balance after minting (should have received 5% fee):
9999997182805637669221
USER1 ETH balance after minting (should have received 95% fee):
9999999773052075743635
üß™ Testing buyMeme functionality...
WETH_ADDRESS=0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
FACTORY_V2_ADDRESS=0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f
Checking if liquidity pool exists...
Pair address: 0x6BF1aF253935298811b3579336A81AA87F906Dc8
‚úÖ Liquidity pool exists, testing buyMeme...
üìà Reading cumulative prices BEFORE buyMeme...
Price0 cumulative before: 0
Price1 cumulative before: 0
Block timestamp before: 5000000000
Block number before: 23103024
Testing buyMeme with 10000000000 wei...
üí∞ USER2 token balance BEFORE buyMeme:
9500000000000000000 [9.5e18]
‚úÖ buyMeme transaction sent successfully!
üí∞ USER2 token balance AFTER buyMeme:
9832999331997327989 [9.832e18]
üìà Tokens gained from buyMeme:
9832999331997327989 [9.832e18] - 9500000000000000000 [9.5e18]
‚è≥ Waiting a moment for time to pass...
üìà Reading cumulative prices AFTER buyMeme...
Price0 cumulative after: 103845937170696552570609926
Price1 cumulative after: 1038459371706965525706099265844019200000000
Block timestamp after: 15000000000
Block number after: 23103026
üßÆ Calculating TWAP price manually...
Token0 in pair: 0x38Fcae0544337e84919FE58FEd9EF3965E86384F
Token1 in pair: 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
Meme token: 0x38Fcae0544337e84919FE58FEd9EF3965E86384F
Time elapsed: 10000000000 seconds
Blocks elapsed: 2
üìä Price Changes:
Price0 cumulative change: 103845937170696552570609926
Price1 cumulative change: 1038459371706965525706099265844019200000000
Meme token is token0, calculating TWAP...
üéØ TWAP Price for meme token (as token0): 10384593717069655
   (This is the average price of token0 in terms of token1 over the time period)

üìã TWAP Explanation:
   - Cumulative prices accumulate over time in Uniswap V2
   - TWAP = (CumulativePriceEnd - CumulativePriceStart) / TimeElapsed
   - This gives us the time-weighted average price over the period
   - The price is in UQ112x112 format (fixed point with 112 fractional bits)

üîÑ Performing additional trades to show price changes over time...
‚è≥ Waiting for time to pass...
üìà Prices before USER3 trade:
üõí USER3 buying meme tokens...

blockHash            0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79
blockNumber          23103028
contractAddress
cumulativeGasUsed    139439
effectiveGasPrice    262322178
from                 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65
gasUsed              139439
logs                 [{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"],"data":"0x000000000000000000000000000000000000000000000000000000012a05f200","blockHash":"0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79","blockNumber":"0x1608634","blockTimestamp":"0x68972857","transactionHash":"0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x0000000000000000000000006bf1af253935298811b3579336a81aa87f906dc8"],"data":"0x000000000000000000000000000000000000000000000000000000012a05f200","blockHash":"0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79","blockNumber":"0x1608634","blockTimestamp":"0x68972857","transactionHash":"0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752","transactionIndex":"0x0","logIndex":"0x1","removed":false},{"address":"0x38fcae0544337e84919fe58fed9ef3965e86384f","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000006bf1af253935298811b3579336a81aa87f906dc8","0x00000000000000000000000015d34aaf54267db7d7c367839aaf71a00a2c6a65"],"data":"0x0000000000000000000000000000000000000000000000000093fe0e392bb753","blockHash":"0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79","blockNumber":"0x1608634","blockTimestamp":"0x68972857","transactionHash":"0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752","transactionIndex":"0x0","logIndex":"0x2","removed":false},{"address":"0x6bf1af253935298811b3579336a81aa87f906dc8","topics":["0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"],"data":"0x00000000000000000000000000000000000000000000000001bd502acc61a63800000000000000000000000000000000000000000000000000000004a817c800","blockHash":"0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79","blockNumber":"0x1608634","blockTimestamp":"0x68972857","transactionHash":"0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752","transactionIndex":"0x0","logIndex":"0x3","removed":false},{"address":"0x6bf1af253935298811b3579336a81aa87f906dc8","topics":["0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x00000000000000000000000015d34aaf54267db7d7c367839aaf71a00a2c6a65"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012a05f2000000000000000000000000000000000000000000000000000093fe0e392bb7530000000000000000000000000000000000000000000000000000000000000000","blockHash":"0x05ac19b0696d9f1b5b931da88db32ea1d26a00ba6ba1de76ae54068c79188b79","blockNumber":"0x1608634","blockTimestamp":"0x68972857","transactionHash":"0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752","transactionIndex":"0x0","logIndex":"0x4","removed":false}]
logsBloom            0x00200000040000000000000080000000000001000000200000010000000000000000000000800000000000000000000002000000080000000000000000000000000000000000020000000008000000200000000000000000100000008000000000000000000000000000000000000000000000000000000000000010000000000000000000000000004000000000000000000001000000080000004100000000000000000000000000000000000000000000000000000000000100000000000000000002000000000000000000000000000000000000001000000000000024000000200000000000000040000000000000010000000000400000000002000000
root
status               1 (success)
transactionHash      0x51d0b1c947ba27ee806b8aaf46dd9835efa309592cee6cd70083b7afee64b752
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x38Fcae0544337e84919FE58FEd9EF3965E86384F
üí∞ USER3 token balance after trade:
41656158618629971 [4.165e16]
‚è≥ Waiting for more time to pass...
üõí USER2 making second trade...

blockHash            0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221
blockNumber          23103030
contractAddress
cumulativeGasUsed    122339
effectiveGasPrice    203387505
from                 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
gasUsed              122339
logs                 [{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"],"data":"0x000000000000000000000000000000000000000000000000000000037e11d600","blockHash":"0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221","blockNumber":"0x1608636","blockTimestamp":"0x68972859","transactionHash":"0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x0000000000000000000000006bf1af253935298811b3579336a81aa87f906dc8"],"data":"0x000000000000000000000000000000000000000000000000000000037e11d600","blockHash":"0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221","blockNumber":"0x1608636","blockTimestamp":"0x68972859","transactionHash":"0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1","transactionIndex":"0x0","logIndex":"0x1","removed":false},{"address":"0x38fcae0544337e84919fe58fed9ef3965e86384f","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000006bf1af253935298811b3579336a81aa87f906dc8","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc"],"data":"0x00000000000000000000000000000000000000000000000000be8559f91cc73e","blockHash":"0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221","blockNumber":"0x1608636","blockTimestamp":"0x68972859","transactionHash":"0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1","transactionIndex":"0x0","logIndex":"0x2","removed":false},{"address":"0x6bf1af253935298811b3579336a81aa87f906dc8","topics":["0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"],"data":"0x00000000000000000000000000000000000000000000000000fecad0d344defa0000000000000000000000000000000000000000000000000000000826299e00","blockHash":"0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221","blockNumber":"0x1608636","blockTimestamp":"0x68972859","transactionHash":"0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1","transactionIndex":"0x0","logIndex":"0x3","removed":false},{"address":"0x6bf1af253935298811b3579336a81aa87f906dc8","topics":["0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000037e11d60000000000000000000000000000000000000000000000000000be8559f91cc73e0000000000000000000000000000000000000000000000000000000000000000","blockHash":"0x6caeaf36b96a86c7ae599a3bfe04a0cb613a4034d45e14032d686fa743774221","blockNumber":"0x1608636","blockTimestamp":"0x68972859","transactionHash":"0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1","transactionIndex":"0x0","logIndex":"0x4","removed":false}]
logsBloom            0x00200000000000000000000080000000000001000000200000010000000000000000000000800000000000000000000002000000080000000000000000100000000000000000020000000008000000200000000000000000100000008000000000000000000000000000000000000000000800000000000000000010000000000000000000000000004000000000000000000001000000080000004000000000000000000000200000000000000000000000000000000000000100000000000000000002000000000000000000000000000000000000001000000000000020000000200000000000000040000000000000010000000000400000000002000000
root
status               1 (success)
transactionHash      0x54a968f6cbba1cd44ad8e125d12664a20ed8dbb5bf2e9e1a8c52a0ed8f7dbdc1
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x38Fcae0544337e84919FE58FEd9EF3965E86384F
üí∞ USER2 final token balance:
9886626199050348979 [9.886e18]
üìà Final cumulative prices after all trades:

üßÆ Calculating TWAP for the entire trading period...
Total time elapsed: 30000000000 seconds
üìä Total Price Changes Over Entire Period:
Price0 total cumulative change: 5025418929804010353162857898
Price1 total cumulative change: 1508196582398196671463277855293172760344494
üéØ Overall TWAP for meme token (entire period): 167513964326800345
   üí∞ Human-readable: 1 MEME = .000000000000000032 ETH

üìä Summary of all price readings:
Initial: Price0=0, Price1=0, Time=5000000000
After 1st trade: Price0=103845937170696552570609926, Price1=1038459371706965525706099265844019200000000, Time=15000000000
Final: Price0=5025418929804010353162857898, Price1=1508196582398196671463277855293172760344494, Time=35000000000
üéâ All tests completed successfully!
