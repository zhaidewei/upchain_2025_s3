üöÄ Starting Call Option Token Deployment and Testing...
üîë Addresses:
ADMIN_ADDRESS=0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
USER1_ADDRESS=0x70997970C51812dc3A010C7d01b50e0d17dc79C8
USER2_ADDRESS=0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
üì¶ Step 1: Deploying Call Option Token contract...
üìä Contract Parameters:
Strike Price: 20000000000000000 wei (0.02 ETH)
Option Fee: 10000000000000000 wei (0.01 ETH)
Duration: 1 days
‚úÖ Call Option Token deployed to: 0x5FbDB2315678afecb367f032d93F642f64180aa3
üîç Step 2: Checking initial contract state...
Contract Info: 20000000000000000 [2e16]
10000000000000000 [1e16]
1755259271 [1.755e9]
0
0
0
false
üí∞ Step 3: Admin depositing 10 ETH and minting tokens...

blockHash            0x01732ad6c26f81e852981a584afaa45d156a1c866783c97fb2d66df78cff9d0d
blockNumber          2
contractAddress
cumulativeGasUsed    94240
effectiveGasPrice    885757351
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              94240
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000000000000000000000000000000000000000000","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x00000000000000000000000000000000000000000000001b1ae4d6e2ef500000","blockHash":"0x01732ad6c26f81e852981a584afaa45d156a1c866783c97fb2d66df78cff9d0d","blockNumber":"0x2","blockTimestamp":"0x689dd007","transactionHash":"0xb81e9675d0391ab61978cf414f15868910916f9693155a2f5611777266a7098d","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8f75401d249f146b92583cd1d15bc09673e775e30c63e1599db99cfadde39126","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x00000000000000000000000000000000000000000000001b1ae4d6e2ef5000000000000000000000000000000000000000000000000000008ac7230489e80000","blockHash":"0x01732ad6c26f81e852981a584afaa45d156a1c866783c97fb2d66df78cff9d0d","blockNumber":"0x2","blockTimestamp":"0x689dd007","transactionHash":"0xb81e9675d0391ab61978cf414f15868910916f9693155a2f5611777266a7098d","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000040020000000000000100000800000000000000000000000010004000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000200000000000000000000000002000000000000000000020000000000000000000000000000000000000000000000000001000000000400000
root
status               1 (success)
transactionHash      0xb81e9675d0391ab61978cf414f15868910916f9693155a2f5611777266a7098d
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
[2m2025-08-14T12:01:11.343250Z[0m [31mERROR[0m [2malloy_rpc_client::poller[0m[2m:[0m failed to poll [3merr[0m[2m=[0merror sending request for url (http://localhost:8545/)
üîç Checking contract state after deposit...
Contract Info after deposit: 20000000000000000 [2e16]
10000000000000000 [1e16]
1755259271 [1.755e9]
10000000000000000000 [1e19]
500000000000000000000 [5e20]
500000000000000000000 [5e20]
false
Admin token balance: 500000000000000000000 [5e20]
üí∞ Step 4: User1 purchasing 50 tokens...

blockHash            0x2875e524d9a4757a821020018ea9c2da051db67d8d8f4d0293617668a1612d71
blockNumber          3
contractAddress
cumulativeGasUsed    80064
effectiveGasPrice    775733298
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              80064
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x000000000000000000000000000000000000000000000002b5e3af16b1880000","blockHash":"0x2875e524d9a4757a821020018ea9c2da051db67d8d8f4d0293617668a1612d71","blockNumber":"0x3","blockTimestamp":"0x689dd007","transactionHash":"0x3d3901ddb4fe25b8c73a454657c648fdbfa4940693cd5443b8ce7884fa6d5da9","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8f75401d249f146b92583cd1d15bc09673e775e30c63e1599db99cfadde39126","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x000000000000000000000000000000000000000000000002b5e3af16b188000000000000000000000000000000000000000000000000000006f05b59d3b20000","blockHash":"0x2875e524d9a4757a821020018ea9c2da051db67d8d8f4d0293617668a1612d71","blockNumber":"0x3","blockTimestamp":"0x689dd007","transactionHash":"0x3d3901ddb4fe25b8c73a454657c648fdbfa4940693cd5443b8ce7884fa6d5da9","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000840000000000000000100000000000000000000000000000010004000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000200000000000000000000000002000000000000000000000000000000000000000000000000000000001000000000000001000000000400000
root
status               1 (success)
transactionHash      0x3d3901ddb4fe25b8c73a454657c648fdbfa4940693cd5443b8ce7884fa6d5da9
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
User1 token balance: 50000000000000000000 [5e19]
üí∞ Step 5: User2 purchasing 100 tokens...

blockHash            0xe2879fe0e03eb9796a495b2c370dabfbd2c0187212afd69a9241fb417169ddb2
blockNumber          4
contractAddress
cumulativeGasUsed    80064
effectiveGasPrice    679284206
from                 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
gasUsed              80064
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0xe2879fe0e03eb9796a495b2c370dabfbd2c0187212afd69a9241fb417169ddb2","blockNumber":"0x4","blockTimestamp":"0x689dd007","transactionHash":"0x7921f8aadeb5f5fc2aece7a3d3d25e2cb748cba26a9a7485bd2509e73efd17d4","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x8f75401d249f146b92583cd1d15bc09673e775e30c63e1599db99cfadde39126","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0xe2879fe0e03eb9796a495b2c370dabfbd2c0187212afd69a9241fb417169ddb2","blockNumber":"0x4","blockTimestamp":"0x689dd007","transactionHash":"0x7921f8aadeb5f5fc2aece7a3d3d25e2cb748cba26a9a7485bd2509e73efd17d4","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000008000000000000000000000000000000000000000000000040000000000000000100000000000800000000000000000010004000000000000000000000000000000000000000000000000000000000000200000000000000000000200000000000000000000000000000000000000000000000000000000042000000200000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000001000000000400000
root
status               1 (success)
transactionHash      0x7921f8aadeb5f5fc2aece7a3d3d25e2cb748cba26a9a7485bd2509e73efd17d4
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
User2 token balance: 100000000000000000000 [1e20]
Admin remaining token balance: 350000000000000000000 [3.5e20]
üîç Step 6: Checking contract state before expiration...
Contract Info before expiry: 20000000000000000 [2e16]
10000000000000000 [1e16]
1755259271 [1.755e9]
10000000000000000000 [1e19]
500000000000000000000 [5e20]
350000000000000000000 [3.5e20]
false
‚è∞ Step 7: Fast forwarding time to expiration...
null
null
Is contract expired:
üí∞ Step 8: User1 exercising 50 tokens...

blockHash            0x0e292d92e6946fab6df98709c46fd6d218ab8e17d70315d6cbf69df0e54f02a8
blockNumber          6
contractAddress
cumulativeGasUsed    45748
effectiveGasPrice    520473537
from                 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
gasUsed              45748
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8","0x0000000000000000000000000000000000000000000000000000000000000000"],"data":"0x000000000000000000000000000000000000000000000002b5e3af16b1880000","blockHash":"0x0e292d92e6946fab6df98709c46fd6d218ab8e17d70315d6cbf69df0e54f02a8","blockNumber":"0x6","blockTimestamp":"0x68a07308","transactionHash":"0x2033e493450b7885e9fc00c8bb0992701ce5f9156a02b100619f2d89c2d0cd7b","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xb7be4ce03884cce4a7938bd1b8ded4e76b7b9486eb84cb0a70cadd9f23ad97ce","0x00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c8"],"data":"0x000000000000000000000000000000000000000000000002b5e3af16b18800000000000000000000000000000000000000000000000000000de0b6b3a7640000","blockHash":"0x0e292d92e6946fab6df98709c46fd6d218ab8e17d70315d6cbf69df0e54f02a8","blockNumber":"0x6","blockTimestamp":"0x68a07308","transactionHash":"0x2033e493450b7885e9fc00c8bb0992701ce5f9156a02b100619f2d89c2d0cd7b","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000002000000000000000000008000000000000000000000000000000000000000000000840020000000000000000000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000100000000000000020000000000000000000000000000000000001000000000000000000000000000000
root
status               1 (success)
transactionHash      0x2033e493450b7885e9fc00c8bb0992701ce5f9156a02b100619f2d89c2d0cd7b
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
User1 ETH balance after exercise: 10000499914081065858252
User1 token balance after exercise: 0
üí∞ Step 9: User2 exercising 100 tokens...

blockHash            0x29bc5904d915bcd768f55d3eb94e6582e866dbeb955401f76edd682651c8e2e3
blockNumber          7
contractAddress
cumulativeGasUsed    45748
effectiveGasPrice    455612767
from                 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC
gasUsed              45748
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc","0x0000000000000000000000000000000000000000000000000000000000000000"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d63100000","blockHash":"0x29bc5904d915bcd768f55d3eb94e6582e866dbeb955401f76edd682651c8e2e3","blockNumber":"0x7","blockTimestamp":"0x68a07308","transactionHash":"0x3b76f0caff4f0a5d702fd1b45653bc8665fd1e911effd53bc86644b883ab8e5c","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xb7be4ce03884cce4a7938bd1b8ded4e76b7b9486eb84cb0a70cadd9f23ad97ce","0x0000000000000000000000003c44cdddb6a900fa2b585dd299e03d12fa4293bc"],"data":"0x0000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000001bc16d674ec80000","blockHash":"0x29bc5904d915bcd768f55d3eb94e6582e866dbeb955401f76edd682651c8e2e3","blockNumber":"0x7","blockTimestamp":"0x68a07308","transactionHash":"0x3b76f0caff4f0a5d702fd1b45653bc8665fd1e911effd53bc86644b883ab8e5c","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000100000002000000000000000000008000000000000000000000000000000000000000000000040020000000000000000000800000800000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000200000000000000000000000000000000000000000000000000000000042000000000000000000000000000000000000100000000000000020000000000000000000000000000000000000000000000000000000000000000000
root
status               1 (success)
transactionHash      0x3b76f0caff4f0a5d702fd1b45653bc8665fd1e911effd53bc86644b883ab8e5c
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
User2 ETH balance after exercise: 10000999924770416466100
User2 token balance after exercise: 0
üí∞ Step 10: Admin expiring and redeeming remaining assets...

blockHash            0x9dde073a97a600184705c7293265c690df0ed14687ab5e8e46d8fbd8b8f06da9
blockNumber          8
contractAddress
cumulativeGasUsed    40112
effectiveGasPrice    398834867
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
gasUsed              40112
logs                 [{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266","0x0000000000000000000000000000000000000000000000000000000000000000"],"data":"0x000000000000000000000000000000000000000000000012f939c99edab80000","blockHash":"0x9dde073a97a600184705c7293265c690df0ed14687ab5e8e46d8fbd8b8f06da9","blockNumber":"0x8","blockTimestamp":"0x68a07308","transactionHash":"0xf4ec68c0d0e2e6a919fb4fedcb737011dbde35990422e86ff48241ce3e8881cc","transactionIndex":"0x0","logIndex":"0x0","removed":false},{"address":"0x5fbdb2315678afecb367f032d93f642f64180aa3","topics":["0x06719f5f750fd3d664360fe82ae656afbe46144fb2efb5121e03aed10033616d","0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],"data":"0x000000000000000000000000000000000000000000000012f939c99edab800000000000000000000000000000000000000000000000000006124fee993bc0000","blockHash":"0x9dde073a97a600184705c7293265c690df0ed14687ab5e8e46d8fbd8b8f06da9","blockNumber":"0x8","blockTimestamp":"0x68a07308","transactionHash":"0xf4ec68c0d0e2e6a919fb4fedcb737011dbde35990422e86ff48241ce3e8881cc","transactionIndex":"0x0","logIndex":"0x1","removed":false}]
logsBloom            0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000008000000000000000000000000000000080000000000000040020000000000000100000800000000000000000000000010000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000042000000200000000000000000000000002000000000000002000020000000000000000000000000000000000000000000000000000000000000000000
root
status               1 (success)
transactionHash      0xf4ec68c0d0e2e6a919fb4fedcb737011dbde35990422e86ff48241ce3e8881cc
transactionIndex     0
type                 2
blobGasPrice         1
blobGasUsed
to                   0x5FbDB2315678afecb367f032d93F642f64180aa3
Admin ETH balance after redemption: 9996998609646161765774
üéØ Final Verification:
Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3
Strike Price: 20000000000000000 wei (0.02 ETH)
Option Fee: 10000000000000000 wei (0.01 ETH)
User1:
  - Purchased: 50 tokens for 0.5 ETH
  - Exercised: 50 tokens for 1 ETH
  - Profit: 0.5 ETH
User2:
  - Purchased: 100 tokens for 1 ETH
  - Exercised: 100 tokens for 2 ETH
  - Profit: 1 ETH
Admin:
  - Deposited: 10 ETH
  - Earned: Option fees from users
  - Redeemed: Remaining ETH after all exercises
üéâ All tests completed successfully!
